"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5386],{33399:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Collector=void 0;var r=n(83701);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=void 0,(e="data")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this.data=n,this.data=[]}var e,n;return e=t,(n=[{key:"get",value:function(t){return(0,r.findExistingMetric)(t,this.data)}},{key:"set",value:function(t,e){var n=(0,r.findExistingMetric)(e,this.data);return n?n.value=t:this.data.push({labels:e,value:t}),this}},{key:"collect",value:function(t){return t?this.data.filter((function(e){if(!e.labels)return!1;for(var n=Object.entries(t),r=0;r<n.length;r+=1){var u=o(n[r],2),i=u[0],a=u[1];if(e.labels[i]!==a)return!1}return!0})):this.data}},{key:"resetAll",value:function(){for(var t=0;t<this.data.length;t+=1)this.reset(this.data[t].labels);return this}}])&&u(e.prototype,n),t}();e.Collector=i},54486:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Counter=void 0;var l=function(t){function e(){return o(this,e),i(this,a(e).apply(this,arguments))}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(r=[{key:"inc",value:function(t){return this.add(1,t),this}},{key:"add",value:function(t,e){if(t<0)throw new Error("Expected increment amount to be greater than -1. Received: ".concat(t));var n=this.get(e);return this.set(n?n.value+t:t,e),this}},{key:"reset",value:function(t){this.set(0,t)}}])&&u(n.prototype,r),e}(n(33399).Collector);e.Counter=l},31993:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Gauge=void 0;var l=function(t){function e(){return o(this,e),i(this,a(e).apply(this,arguments))}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(r=[{key:"dec",value:function(t){var e=this.get(t);return this.set(e?e.value-1:0,t),this}},{key:"sub",value:function(t,e){var n=this.get(e);return this.set(n?n.value-t:0,e),this}}])&&u(n.prototype,r),e}(n(54486).Counter);e.Gauge=l},78215:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?c(t):e}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return{entries:t.reduce((function(t,e){return t[e.toString()]=0,t}),{"+Inf":0}),sum:0,count:0,raw:[]}}Object.defineProperty(e,"__esModule",{value:!0}),e.Histogram=void 0;var y=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o(this,e),f(c(t=i(this,a(e).call(this))),"buckets",void 0),t.buckets=n.sort((function(t,e){return t>e?1:-1})),t.set(s(t.buckets)),t.observe=t.observe.bind(c(t)),t}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,t),n=e,(r=[{key:"observe",value:function(t,e){var n=this.get(e);null==n&&(n=this.set(s(this.buckets),e).get(e)),n.value.raw.push(t),n.value.entries["+Inf"]+=1;var r=function(t,e){if(e<t[t.length-1])for(var n=0;n<t.length;n+=1)if(e<=t[n])return n}(this.buckets,t);if(null!=r)for(var o=r;o<this.buckets.length;o+=1){var u=n.value.entries[this.buckets[o].toString()];n.value.entries[this.buckets[o].toString()]=u+1}return n.value.sum=n.value.raw.reduce((function(t,e){return t+e}),0),n.value.count+=1,this}},{key:"reset",value:function(t){this.set(s(this.buckets),t)}}])&&u(n.prototype,r),e}(n(33399).Collector);e.Histogram=y},44427:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r={};e.default=void 0;var o=n(34961),u=n(95262);Object.keys(u).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return u[t]}}))})),e.default=function(){return new o.Registry}},34961:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Registry=void 0;var r=n(54486),o=n(31993),u=n(78215),i=n(83701);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=void 0,(e="data")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this.data=n,this.data={counter:{},gauge:{},histogram:{}}}var e,n;return e=t,n=[{key:"validateInput",value:function(t,e,n,r){if(""===String(e))throw new Error("Metric name cannot be empty");if(-1===["counter","gauge","histogram"].indexOf(t))throw new Error("Unknown metric type ".concat(t));if("string"!=typeof n&&null!=n)throw new Error("help must be string or undefined/null");if(this.data[t][e])throw new Error("A metric with the name '".concat(e,"' already exists for type '").concat(t,"'"));if(!Array.isArray(r)&&null!=r)throw new Error("buckets must be array or undefined/null")}},{key:"create",value:function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return this.validateInput(t,e,i,a),"counter"===t?(n=new r.Counter,this.data.counter[e]={help:i,instance:n,type:t}):"gauge"===t?(n=new o.Gauge,this.data.gauge[e]={help:i,instance:n,type:t}):(n=new u.Histogram(a),this.data.histogram[e]={help:i,instance:n,type:t}),n}},{key:"metrics",value:function(){return Object.entries(this.data).reduce((function(t,e){var n=a(e,2),r=n[0],o=n[1];return t+Object.entries(o).reduce((function(t,e){var n=a(e,2),o=n[0],u=n[1],c=u.instance.collect(),l=t;return u.help.length>0&&(l+="# HELP ".concat(o," ").concat(u.help,"\n")),(l+="# TYPE ".concat(o," ").concat(r,"\n"))+c.reduce((function(t,e){return t+("histogram"===r?(0,i.formatHistogramOrSummary)(o,e):(0,i.formatCounterOrGauge)(o,e))}),"")}),"")}),"")}},{key:"reset",value:function(){return Object.values(this.data).map((function(t){return Object.values(t).map((function(t){return t.instance.resetAll()}))})),this}},{key:"clear",value:function(){return this.data={counter:{},gauge:{},histogram:{}},this}},{key:"get",value:function(t,e){var n=(null!=t?[this.data[t]]:Object.values(this.data)).find((function(t){return e in t}));return null!=n?n[e].instance:void 0}}],n&&c(e.prototype,n),t}();e.Registry=l},95262:function(){},83701:function(t,e){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){var e=Object.entries(t.labels||{}).map((function(t){var e=n(t,2),r=e[0],o=e[1];return"".concat(r,'="').concat(o,'"')}));return 0===e.length?"":"".concat(e.join(","))}Object.defineProperty(e,"__esModule",{value:!0}),e.formatHistogramOrSummary=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"le",u="",i=r(e);return i.length>0?(u+="".concat(t,"_count{").concat(i,"} ").concat(e.value.count,"\n"),u+="".concat(t,"_sum{").concat(i,"} ").concat(e.value.sum,"\n")):(u+="".concat(t,"_count ").concat(e.value.count,"\n"),u+="".concat(t,"_sum ").concat(e.value.sum,"\n")),Object.entries(e.value.entries).reduce((function(e,r){var u=n(r,2),a=u[0],c=u[1];return i.length>0?"".concat(e).concat(t,"_bucket{").concat(o,'="').concat(a,'",').concat(i,"} ").concat(c,"\n"):"".concat(e).concat(t,"_bucket{").concat(o,'="').concat(a,'"} ').concat(c,"\n")}),u)},e.findExistingMetric=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t?e.find((function(e){if(!e.labels)return!1;if(Object.keys(e.labels||{}).length!==Object.keys(t).length)return!1;for(var r=Object.entries(t),o=0;o<r.length;o+=1){var u=n(r[o],2),i=u[0],a=u[1];if(e.labels[i]!==a)return!1}return!0})):e[0]},e.formatCounterOrGauge=function(t,e){var r=" ".concat(e.value.toString());if(null==e.labels||0===Object.keys(e.labels).length)return"".concat(t).concat(r,"\n");var o=Object.entries(e.labels).map((function(t){var e=n(t,2),r=e[0],o=e[1];return"".concat(r,'="').concat(o,'"')}));return"".concat(t,"{").concat(o.join(","),"}").concat(r,"\n")}}}]);
//# sourceMappingURL=npm.promjs-fc471d64015625b1398d.js.map